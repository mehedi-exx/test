<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>দোকান ক্যালকুলেটর ও রসিদ প্রিন্টার</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #3498db;
            --secondary: #2c3e50;
            --accent: #e74c3c;
            --light: #ecf0f1;
            --dark: #2c3e50;
            --success: #27ae60;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            color: var(--dark);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        /* হেডার স্টাইল */
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            margin-bottom: 20px;
            border-bottom: 2px solid var(--primary);
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .logo h1 {
            font-size: 1.8rem;
            color: var(--secondary);
        }
        
        .logo i {
            font-size: 2rem;
            color: var(--primary);
        }
        
        /* মোবাইল মেনু আইকন */
        .menu-icon {
            display: none;
            font-size: 1.8rem;
            cursor: pointer;
            color: var(--secondary);
        }
        
        /* প্রধান কন্টেন্ট */
        .main-content {
            display: grid;
            grid-template-columns: 1fr 350px;
            gap: 25px;
        }
        
        /* ক্যালকুলেটর স্টাইল */
        .calculator {
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            padding: 25px;
        }
        
        .calculator-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            align-items: center;
        }
        
        .calculator-header h2 {
            color: var(--secondary);
        }
        
        .display {
            background-color: var(--light);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
            text-align: right;
            font-size: 2rem;
            min-height: 70px;
            overflow: hidden;
        }
        
        .buttons {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 12px;
        }
        
        .btn {
            padding: 18px 10px;
            border: none;
            border-radius: 8px;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            background-color: #f0f0f0;
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 10px rgba(0,0,0,0.1);
        }
        
        .btn.operator {
            background-color: var(--primary);
            color: white;
        }
        
        .btn.equal {
            background-color: var(--success);
            color: white;
            grid-column: span 2;
        }
        
        .btn.clear {
            background-color: var(--accent);
            color: white;
        }
        
        /* আইটেম সেকশন */
        .items-section {
            margin-top: 25px;
            padding-top: 20px;
            border-top: 2px dashed #ddd;
        }
        
        .item-input {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .item-input input {
            flex: 1;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
        }
        
        .item-input button {
            background-color: var(--primary);
            color: white;
            border: none;
            padding: 0 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
        }
        
        .items-list {
            max-height: 200px;
            overflow-y: auto;
            margin-bottom: 15px;
            border: 1px solid #eee;
            border-radius: 8px;
            padding: 10px;
        }
        
        .item {
            display: flex;
            justify-content: space-between;
            padding: 10px;
            border-bottom: 1px solid #eee;
        }
        
        .item:last-child {
            border-bottom: none;
        }
        
        .item .name {
            font-weight: bold;
        }
        
        .item .price {
            color: var(--success);
        }
        
        .item .delete {
            color: var(--accent);
            cursor: pointer;
        }
        
        .total {
            display: flex;
            justify-content: space-between;
            font-size: 1.3rem;
            font-weight: bold;
            padding: 10px 0;
        }
        
        .actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        
        .actions button {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
        }
        
        .print-btn {
            background-color: var(--success);
            color: white;
        }
        
        .clear-btn {
            background-color: var(--accent);
            color: white;
        }
        
        /* সাইডবার স্টাইল */
        .sidebar {
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            padding: 25px;
            display: flex;
            flex-direction: column;
        }
        
        .sidebar-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            align-items: center;
        }
        
        .sidebar-header h2 {
            color: var(--secondary);
        }
        
        .settings-form {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .form-group label {
            font-weight: bold;
            color: var(--secondary);
        }
        
        .form-group input {
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
        }
        
        .password-reset {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 2px dashed #ddd;
        }
        
        .password-reset h3 {
            margin-bottom: 15px;
            color: var(--secondary);
        }
        
        .reset-btn {
            background-color: var(--accent);
            color: white;
            border: none;
            padding: 12px;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            width: 100%;
        }
        
        .backup-info {
            background-color: var(--light);
            padding: 15px;
            border-radius: 8px;
            margin-top: auto;
            font-size: 0.9rem;
        }
        
        .backup-info i {
            color: var(--success);
            margin-right: 10px;
        }
        
        /* রেসপন্সিভ স্টাইল */
        @media (max-width: 900px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .sidebar {
                display: none;
            }
            
            .menu-icon {
                display: block;
            }
            
            .sidebar.active {
                display: flex;
                position: fixed;
                top: 0;
                right: 0;
                height: 100vh;
                width: 90%;
                max-width: 400px;
                z-index: 100;
                border-radius: 0;
                overflow-y: auto;
            }
        }
        
        @media (max-width: 600px) {
            .buttons {
                grid-template-columns: repeat(4, 1fr);
                gap: 8px;
            }
            
            .btn {
                padding: 14px 5px;
                font-size: 1rem;
            }
            
            .logo h1 {
                font-size: 1.4rem;
            }
        }
        
        /* প্রিন্ট স্টাইল */
        @media print {
            body * {
                visibility: hidden;
            }
            .receipt-print, .receipt-print * {
                visibility: visible;
            }
            .receipt-print {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">
                <i class="fas fa-calculator"></i>
                <h1>দোকান ক্যালকুলেটর ও রসিদ</h1>
            </div>
            <div class="menu-icon" id="menuToggle">
                <i class="fas fa-bars"></i>
            </div>
        </header>
        
        <div class="main-content">
            <div class="calculator">
                <div class="calculator-header">
                    <h2>ক্যালকুলেটর</h2>
                    <div class="display" id="display">0</div>
                </div>
                
                <div class="buttons">
                    <button class="btn clear" onclick="clearDisplay()">C</button>
                    <button class="btn operator" onclick="appendOperator('/')">/</button>
                    <button class="btn operator" onclick="appendOperator('*')">×</button>
                    <button class="btn" onclick="appendNumber('7')">7</button>
                    <button class="btn" onclick="appendNumber('8')">8</button>
                    <button class="btn" onclick="appendNumber('9')">9</button>
                    <button class="btn operator" onclick="appendOperator('-')">-</button>
                    <button class="btn" onclick="appendNumber('4')">4</button>
                    <button class="btn" onclick="appendNumber('5')">5</button>
                    <button class="btn" onclick="appendNumber('6')">6</button>
                    <button class="btn operator" onclick="appendOperator('+')">+</button>
                    <button class="btn" onclick="appendNumber('1')">1</button>
                    <button class="btn" onclick="appendNumber('2')">2</button>
                    <button class="btn" onclick="appendNumber('3')">3</button>
                    <button class="btn equal" onclick="calculate()">=</button>
                    <button class="btn" onclick="appendNumber('0')">0</button>
                    <button class="btn" onclick="appendNumber('.')">.</button>
                </div>
                
                <div class="items-section">
                    <h3>আইটেম যোগ করুন</h3>
                    <div class="item-input">
                        <input type="text" id="itemName" placeholder="আইটেমের নাম লিখুন">
                        <button onclick="addItem()">যোগ করুন</button>
                    </div>
                    
                    <div class="items-list" id="itemsList">
                        <!-- Items will be added here dynamically -->
                    </div>
                    
                    <div class="total">
                        <span>মোট:</span>
                        <span id="totalAmount">৳ 0</span>
                    </div>
                    
                    <div class="actions">
                        <button class="print-btn" onclick="printReceipt()"><i class="fas fa-print"></i> প্রিন্ট করুন</button>
                        <button class="clear-btn" onclick="clearAll()"><i class="fas fa-trash"></i> সাফ করুন</button>
                    </div>
                </div>
            </div>
            
            <div class="sidebar" id="sidebar">
                <div class="sidebar-header">
                    <h2>দোকান সেটিংস</h2>
                    <i class="fas fa-times close-icon" id="closeMenu"></i>
                </div>
                
                <form class="settings-form">
                    <div class="form-group">
                        <label for="shopName">দোকানের নাম</label>
                        <input type="text" id="shopName" value="আমার দোকান">
                    </div>
                    
                    <div class="form-group">
                        <label for="shopAddress">ঠিকানা</label>
                        <input type="text" id="shopAddress" value="মেইন রোড, ঢাকা">
                    </div>
                    
                    <div class="form-group">
                        <label for="shopPhone">ফোন নম্বর</label>
                        <input type="text" id="shopPhone" value="০১৭১১২৩৪৫৬৭">
                    </div>
                    
                    <div class="form-group">
                        <label for="vatRate">ভ্যাট রেট (%)</label>
                        <input type="number" id="vatRate" value="5">
                    </div>
                </form>
                
                <div class="password-reset">
                    <h3>পাসওয়ার্ড রিসেট</h3>
                    <p>ডিফল্ট পাসওয়ার্ড: <strong>reset123</strong></p>
                    <button class="reset-btn" onclick="resetSettings()">সেটিংস রিসেট করুন</button>
                </div>
                
                <div class="backup-info">
                    <p><i class="fas fa-check-circle"></i> দৈনিক ব্যাকআপ সক্রিয়। সর্বশেষ ব্যাকআপ: আজ সকাল ১২:০০ AM</p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- প্রিন্টের জন্য রসিদ -->
    <div class="receipt-print" id="receiptPrint" style="display: none;">
        <div style="text-align: center; margin-bottom: 20px;">
            <h2 id="printShopName">আমার দোকান</h2>
            <p id="printShopAddress">মেইন রোড, ঢাকা</p>
            <p id="printShopPhone">০১৭১১২৩৪৫৬৭</p>
            <p>তারিখ: <span id="printDate"></span></p>
        </div>
        
        <table style="width: 100%; border-collapse: collapse; margin: 20px 0;">
            <thead>
                <tr>
                    <th style="text-align: left; border-bottom: 1px dashed #000; padding: 8px 0;">আইটেম</th>
                    <th style="text-align: right; border-bottom: 1px dashed #000; padding: 8px 0;">মূল্য</th>
                </tr>
            </thead>
            <tbody id="printItems">
                <!-- Items will be added here for printing -->
            </tbody>
        </table>
        
        <div style="text-align: right; margin-top: 20px;">
            <p>মোট: ৳<span id="printTotal">0</span></p>
            <p>ভ্যাট (5%): ৳<span id="printVat">0</span></p>
            <p style="font-weight: bold; font-size: 1.2rem; margin-top: 10px;">সর্বমোট: ৳<span id="printGrandTotal">0</span></p>
        </div>
        
        <div style="text-align: center; margin-top: 30px; font-style: italic;">
            <p>ধন্যবাদ, আবার আসবেন!</p>
        </div>
    </div>

    <script>
        // DOM elements
        const display = document.getElementById('display');
        const itemsList = document.getElementById('itemsList');
        const totalAmount = document.getElementById('totalAmount');
        const menuToggle = document.getElementById('menuToggle');
        const sidebar = document.getElementById('sidebar');
        const closeMenu = document.getElementById('closeMenu');
        
        // State variables
        let currentInput = '0';
        let items = [];
        
        // Initialize the app
        function initializeApp() {
            loadSettings();
            loadItems();
            updateDisplay();
            updateItemsList();
            updateTotal();
            
            // Set current date
            const now = new Date();
            document.getElementById('printDate').textContent = now.toLocaleDateString('bn-BD');
        }
        
        // Calculator functions
        function appendNumber(num) {
            if (currentInput === '0' && num !== '.') {
                currentInput = num;
            } else {
                currentInput += num;
            }
            updateDisplay();
        }
        
        function appendOperator(operator) {
            if (currentInput.slice(-1) !== operator) {
                currentInput += operator;
                updateDisplay();
            }
        }
        
        function clearDisplay() {
            currentInput = '0';
            updateDisplay();
        }
        
        function calculate() {
            try {
                // Replace × with * for evaluation
                const expression = currentInput.replace(/×/g, '*');
                const result = eval(expression);
                currentInput = result.toString();
                updateDisplay();
            } catch (error) {
                currentInput = 'Error';
                updateDisplay();
                setTimeout(() => {
                    currentInput = '0';
                    updateDisplay();
                }, 1500);
            }
        }
        
        function updateDisplay() {
            display.textContent = currentInput;
        }
        
        // Item management
        function addItem() {
            const itemName = document.getElementById('itemName').value;
            if (!itemName) {
                alert('আইটেমের নাম লিখুন');
                return;
            }
            
            let price;
            try {
                // Replace × with * for evaluation
                const expression = currentInput.replace(/×/g, '*');
                price = eval(expression);
            } catch {
                alert('অবৈধ গণনা');
                return;
            }
            
            items.push({
                id: Date.now(),
                name: itemName,
                price: price
            });
            
            document.getElementById('itemName').value = '';
            currentInput = '0';
            updateDisplay();
            updateItemsList();
            updateTotal();
            saveItems();
        }
        
        function removeItem(id) {
            items = items.filter(item => item.id !== id);
            updateItemsList();
            updateTotal();
            saveItems();
        }
        
        function updateItemsList() {
            itemsList.innerHTML = '';
            
            if (items.length === 0) {
                itemsList.innerHTML = '<p style="text-align: center; color: #777;">কোন আইটেম যোগ করা হয়নি</p>';
                return;
            }
            
            items.forEach(item => {
                const itemElement = document.createElement('div');
                itemElement.className = 'item';
                itemElement.innerHTML = `
                    <span class="name">${item.name}</span>
                    <span class="price">৳ ${item.price.toFixed(2)}</span>
                    <span class="delete" onclick="removeItem(${item.id})"><i class="fas fa-trash"></i></span>
                `;
                itemsList.appendChild(itemElement);
            });
        }
        
        function updateTotal() {
            const total = items.reduce((sum, item) => sum + item.price, 0);
            totalAmount.textContent = `৳ ${total.toFixed(2)}`;
        }
        
        function clearAll() {
            if (confirm('আপনি কি নিশ্চিত যে আপনি সবকিছু সাফ করতে চান?')) {
                items = [];
                currentInput = '0';
                updateDisplay();
                updateItemsList();
                updateTotal();
                saveItems();
            }
        }
        
        // Settings functions
        function loadSettings() {
            const savedSettings = localStorage.getItem('shopSettings');
            if (savedSettings) {
                const settings = JSON.parse(savedSettings);
                document.getElementById('shopName').value = settings.name;
                document.getElementById('shopAddress').value = settings.address;
                document.getElementById('shopPhone').value = settings.phone;
                document.getElementById('vatRate').value = settings.vatRate;
            }
            saveSettings(); // Save to set defaults if not exists
        }
        
        function saveSettings() {
            const settings = {
                name: document.getElementById('shopName').value,
                address: document.getElementById('shopAddress').value,
                phone: document.getElementById('shopPhone').value,
                vatRate: document.getElementById('vatRate').value
            };
            localStorage.setItem('shopSettings', JSON.stringify(settings));
        }
        
        function resetSettings() {
            const password = prompt('রিসেট করতে ডিফল্ট পাসওয়ার্ড লিখুন:');
            if (password === 'reset123') {
                document.getElementById('shopName').value = 'আমার দোকান';
                document.getElementById('shopAddress').value = 'মেইন রোড, ঢাকা';
                document.getElementById('shopPhone').value = '০১৭১১২৩৪৫৬৭';
                document.getElementById('vatRate').value = '5';
                saveSettings();
                alert('সেটিংস সফলভাবে রিসেট করা হয়েছে!');
            } else {
                alert('ভুল পাসওয়ার্ড!');
            }
        }
        
        // Backup functions
        function dailyBackup() {
            const today = new Date().toLocaleDateString();
            const lastBackup = localStorage.getItem('lastBackupDate');
            
            if (lastBackup !== today) {
                const backupData = {
                    date: today,
                    items: items,
                    settings: JSON.parse(localStorage.getItem('shopSettings'))
                };
                
                localStorage.setItem('backup_' + today, JSON.stringify(backupData));
                localStorage.setItem('lastBackupDate', today);
                console.log('Daily backup completed for', today);
            }
        }
        
        // Save and load items
        function saveItems() {
            localStorage.setItem('currentItems', JSON.stringify(items));
        }
        
        function loadItems() {
            const savedItems = localStorage.getItem('currentItems');
            if (savedItems) {
                items = JSON.parse(savedItems);
            }
        }
        
        // Print receipt
        function printReceipt() {
            if (items.length === 0) {
                alert('প্রিন্ট করার জন্য প্রথমে কিছু আইটেম যোগ করুন');
                return;
            }
            
            const settings = JSON.parse(localStorage.getItem('shopSettings'));
            const total = items.reduce((sum, item) => sum + item.price, 0);
            const vat = total * (parseFloat(settings.vatRate) / 100);
            const grandTotal = total + vat;
            
            // Update print elements
            document.getElementById('printShopName').textContent = settings.name;
            document.getElementById('printShopAddress').textContent = settings.address;
            document.getElementById('printShopPhone').textContent = settings.phone;
            
            const printItems = document.getElementById('printItems');
            printItems.innerHTML = '';
            
            items.forEach(item => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td style="padding: 8px 0;">${item.name}</td>
                    <td style="text-align: right; padding: 8px 0;">৳ ${item.price.toFixed(2)}</td>
                `;
                printItems.appendChild(tr);
            });
            
            document.getElementById('printTotal').textContent = total.toFixed(2);
            document.getElementById('printVat').textContent = vat.toFixed(2);
            document.getElementById('printGrandTotal').textContent = grandTotal.toFixed(2);
            
            // Show and print the receipt
            const receipt = document.getElementById('receiptPrint');
            receipt.style.display = 'block';
            window.print();
            receipt.style.display = 'none';
        }
        
        // Event listeners
        menuToggle.addEventListener('click', () => {
            sidebar.classList.add('active');
        });
        
        closeMenu.addEventListener('click', () => {
            sidebar.classList.remove('active');
        });
        
        // Save settings when inputs change
        const settingsInputs = document.querySelectorAll('.settings-form input');
        settingsInputs.forEach(input => {
            input.addEventListener('change', saveSettings);
        });
        
        // Initialize the app
        window.onload = initializeApp;
        
        // Setup daily backup check
        setInterval(dailyBackup, 3600000); // Check every hour
        dailyBackup(); // Initial backup check
    </script>
</body>
</html>
